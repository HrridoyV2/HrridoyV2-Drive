(this["webpackJsonpfirebase-react-auth"]=this["webpackJsonpfirebase-react-auth"]||[]).push([[0],{73:function(e,t,a){e.exports=a(94)},94:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),c=a(20),l=a.n(c),o=a(6),u=a(12),s=a(55),i=a.n(s),m=(a(78),a(80),a(95),i.a.initializeApp({apiKey:"AIzaSyAWJbUkZSoLX0LmTA8soGhZdDW5eHhVlAo",authDomain:"hridoyv2-drive.firebaseapp.com",projectId:"hridoyv2-drive",storageBucket:"hridoyv2-drive.appspot.com",messagingSenderId:"768881360704",appId:"1:768881360704:web:d3ddbfa2d467c7d77584a5"})),d=m.firestore(),p={folders:d.collection("folders"),files:d.collection("files"),formatDoc:function(e){return Object(u.a)({id:e.id},e.data())},getCurrentTimestamp:i.a.firestore.FieldValue.serverTimestamp},f=m.storage(),b=m.auth(),E=n.a.createContext();function h(){return Object(r.useContext)(E)}function v(e){var t=e.children,a=Object(r.useState)(),c=Object(o.a)(a,2),l=c[0],u=c[1],s=Object(r.useState)(!0),i=Object(o.a)(s,2),m=i[0],d=i[1];Object(r.useEffect)((function(){return b.onAuthStateChanged((function(e){u(e),d(!1)}))}),[]);var p={currentUser:l,login:function(e,t){return b.signInWithEmailAndPassword(e,t)},signup:function(e,t){return b.createUserWithEmailAndPassword(e,t)},logout:function(){return b.signOut()},resetPassword:function(e){return b.sendPasswordResetEmail(e)},updateEmail:function(e){return l.updateEmail(e)},updatePassword:function(e){return l.updatePassword(e)}};return n.a.createElement(E.Provider,{value:p},!m&&t)}var g=a(8),j=a(9),O=a(14),y=a.n(O),w=a(24),x=a(105),N=a(97),k=a(98);function F(){var e=Object(r.useState)(""),t=Object(o.a)(e,2),a=t[0],c=t[1],l=h(),u=l.currentUser,s=l.logout,i=Object(j.g)();function m(){return(m=Object(w.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(""),e.prev=1,e.next=4,s();case 4:i.push("/login"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),c("Failed to log out");case 10:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}return n.a.createElement(n.a.Fragment,null,n.a.createElement(x.a,null,n.a.createElement(x.a.Body,null,n.a.createElement("h2",{className:"text-center mb-4"},"Profile"),a&&n.a.createElement(N.a,{variant:"danger"},a),n.a.createElement("strong",null,"Email:")," ",u.email,n.a.createElement(g.b,{to:"/update-profile",className:"btn btn-primary w-100 mt-3"},"Update Profile"))),n.a.createElement("div",{className:"w-100 text-center mt-2"},n.a.createElement(k.a,{variant:"link",onClick:function(){return m.apply(this,arguments)}},"Log Out")))}var S=a(101),C=a(99);var I=function(e){var t=e.children;return n.a.createElement(C.a,{className:"d-flex align-items-center justify-content-center",style:{minHeight:"100vh"}},n.a.createElement("div",{className:"w-100",style:{maxWidth:"400px"}},t))};function P(){var e=Object(r.useRef)(),t=Object(r.useRef)(),a=h().login,c=Object(r.useState)(""),l=Object(o.a)(c,2),u=l[0],s=l[1],i=Object(r.useState)(!1),m=Object(o.a)(i,2),d=m[0],p=m[1],f=Object(j.g)();function b(){return(b=Object(w.a)(y.a.mark((function r(n){return y.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n.preventDefault(),r.prev=1,s(""),p(!0),r.next=6,a(e.current.value,t.current.value);case 6:f.push("/"),r.next=12;break;case 9:r.prev=9,r.t0=r.catch(1),s("Failed to log in");case 12:p(!1);case 13:case"end":return r.stop()}}),r,null,[[1,9]])})))).apply(this,arguments)}return n.a.createElement(I,null,n.a.createElement(x.a,null,n.a.createElement(x.a.Body,null,n.a.createElement("h2",{className:"text-center mb-4"},"Log In"),u&&n.a.createElement(N.a,{variant:"danger"},u),n.a.createElement(S.a,{onSubmit:function(e){return b.apply(this,arguments)}},n.a.createElement(S.a.Group,{id:"email"},n.a.createElement(S.a.Label,null,"Email"),n.a.createElement(S.a.Control,{type:"email",ref:e,required:!0})),n.a.createElement(S.a.Group,{id:"password"},n.a.createElement(S.a.Label,null,"Password"),n.a.createElement(S.a.Control,{type:"password",ref:t,required:!0})),n.a.createElement(k.a,{disabled:d,className:"w-100",type:"submit"},"Log In")),n.a.createElement("div",{className:"w-100 text-center mt-3"},n.a.createElement(g.b,{to:"/forgot-password"},"Forgot Password?")))),n.a.createElement("div",{className:"w-100 text-center mt-2"},"Need an account? ",n.a.createElement(g.b,{to:"/signup"},"Sign Up")))}var L=a(72);function U(e){var t=e.component,a=Object(L.a)(e,["component"]),r=h().currentUser;return n.a.createElement(j.b,Object.assign({},a,{render:function(e){return r?n.a.createElement(t,e):n.a.createElement(j.a,{to:"/login"})}}))}function R(){var e=Object(r.useRef)(),t=Object(r.useRef)(),a=Object(r.useRef)(),c=h().signup,l=Object(r.useState)(""),u=Object(o.a)(l,2),s=u[0],i=u[1],m=Object(r.useState)(!1),d=Object(o.a)(m,2),p=d[0],f=d[1],b=Object(j.g)();function E(){return(E=Object(w.a)(y.a.mark((function r(n){return y.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n.preventDefault(),t.current.value===a.current.value){r.next=3;break}return r.abrupt("return",i("Passwords do not match"));case 3:return r.prev=3,i(""),f(!0),r.next=8,c(e.current.value,t.current.value);case 8:b.push("/"),r.next=14;break;case 11:r.prev=11,r.t0=r.catch(3),i("Failed to create an account");case 14:f(!1);case 15:case"end":return r.stop()}}),r,null,[[3,11]])})))).apply(this,arguments)}return n.a.createElement(I,null,n.a.createElement(x.a,null,n.a.createElement(x.a.Body,null,n.a.createElement("h2",{className:"text-center mb-4"},"Sign Up"),s&&n.a.createElement(N.a,{variant:"danger"},s),n.a.createElement(S.a,{onSubmit:function(e){return E.apply(this,arguments)}},n.a.createElement(S.a.Group,{id:"email"},n.a.createElement(S.a.Label,null,"Email"),n.a.createElement(S.a.Control,{type:"email",ref:e,required:!0})),n.a.createElement(S.a.Group,{id:"password"},n.a.createElement(S.a.Label,null,"Password"),n.a.createElement(S.a.Control,{type:"password",ref:t,required:!0})),n.a.createElement(S.a.Group,{id:"password-confirm"},n.a.createElement(S.a.Label,null,"Password Confirmation"),n.a.createElement(S.a.Control,{type:"password",ref:a,required:!0})),n.a.createElement(k.a,{disabled:p,className:"w-100",type:"submit"},"Sign Up")))),n.a.createElement("div",{className:"w-100 text-center mt-2"},"Already have an account? ",n.a.createElement(g.b,{to:"/login"},"Log In")))}function A(){var e=Object(r.useRef)(),t=h().resetPassword,a=Object(r.useState)(""),c=Object(o.a)(a,2),l=c[0],u=c[1],s=Object(r.useState)(""),i=Object(o.a)(s,2),m=i[0],d=i[1],p=Object(r.useState)(!1),f=Object(o.a)(p,2),b=f[0],E=f[1];function v(){return(v=Object(w.a)(y.a.mark((function a(r){return y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r.preventDefault(),a.prev=1,d(""),u(""),E(!0),a.next=7,t(e.current.value);case 7:d("Check your inbox for further instructions"),a.next=13;break;case 10:a.prev=10,a.t0=a.catch(1),u("Failed to reset password");case 13:E(!1);case 14:case"end":return a.stop()}}),a,null,[[1,10]])})))).apply(this,arguments)}return n.a.createElement(I,null,n.a.createElement(x.a,null,n.a.createElement(x.a.Body,null,n.a.createElement("h2",{className:"text-center mb-4"},"Password Reset"),l&&n.a.createElement(N.a,{variant:"danger"},l),m&&n.a.createElement(N.a,{variant:"success"},m),n.a.createElement(S.a,{onSubmit:function(e){return v.apply(this,arguments)}},n.a.createElement(S.a.Group,{id:"email"},n.a.createElement(S.a.Label,null,"Email"),n.a.createElement(S.a.Control,{type:"email",ref:e,required:!0})),n.a.createElement(k.a,{disabled:b,className:"w-100",type:"submit"},"Reset Password")),n.a.createElement("div",{className:"w-100 text-center mt-3"},n.a.createElement(g.b,{to:"/login"},"Login")))),n.a.createElement("div",{className:"w-100 text-center mt-2"},"Need an account? ",n.a.createElement(g.b,{to:"/signup"},"Sign Up")))}function B(){var e=Object(r.useRef)(),t=Object(r.useRef)(),a=Object(r.useRef)(),c=h(),l=c.currentUser,u=c.updatePassword,s=c.updateEmail,i=Object(r.useState)(""),m=Object(o.a)(i,2),d=m[0],p=m[1],f=Object(r.useState)(!1),b=Object(o.a)(f,2),E=b[0],v=b[1],O=Object(j.g)();return n.a.createElement(I,null,n.a.createElement(x.a,null,n.a.createElement(x.a.Body,null,n.a.createElement("h2",{className:"text-center mb-4"},"Update Profile"),d&&n.a.createElement(N.a,{variant:"danger"},d),n.a.createElement(S.a,{onSubmit:function(r){if(r.preventDefault(),t.current.value!==a.current.value)return p("Passwords do not match");var n=[];v(!0),p(""),e.current.value!==l.email&&n.push(s(e.current.value)),t.current.value&&n.push(u(t.current.value)),Promise.all(n).then((function(){O.push("/user")})).catch((function(){p("Failed to update account")})).finally((function(){v(!1)}))}},n.a.createElement(S.a.Group,{id:"email"},n.a.createElement(S.a.Label,null,"Email"),n.a.createElement(S.a.Control,{type:"email",ref:e,required:!0,defaultValue:l.email})),n.a.createElement(S.a.Group,{id:"password"},n.a.createElement(S.a.Label,null,"Password"),n.a.createElement(S.a.Control,{type:"password",ref:t,placeholder:"Leave blank to keep the same"})),n.a.createElement(S.a.Group,{id:"password-confirm"},n.a.createElement(S.a.Label,null,"Password Confirmation"),n.a.createElement(S.a.Control,{type:"password",ref:a,placeholder:"Leave blank to keep the same"})),n.a.createElement(k.a,{disabled:E,className:"w-100",type:"submit"},"Update")))),n.a.createElement("div",{className:"w-100 text-center mt-2"},n.a.createElement(g.b,{to:"/user"},"Cancel")))}var D=a(35),G=a(100),W=a(27),q=a(28),T="select-folder",H="update-folder",V="set-child-folders",z="set-child-files",J={name:"Root",id:null,path:[]};function M(e,t){var a=t.type,r=t.payload;switch(a){case T:return{folderId:r.folderId,folder:r.folder,childFiles:[],childFolders:[]};case H:return Object(u.a)(Object(u.a)({},e),{},{folder:r.folder});case V:return Object(u.a)(Object(u.a)({},e),{},{childFolders:r.childFolders});case z:return Object(u.a)(Object(u.a)({},e),{},{childFiles:r.childFiles});default:return e}}function Z(e){var t=e.currentFolder,a=Object(r.useState)(!1),c=Object(o.a)(a,2),l=c[0],u=c[1],s=Object(r.useState)(""),i=Object(o.a)(s,2),m=i[0],d=i[1],f=h().currentUser;function b(){u(!1)}return n.a.createElement(n.a.Fragment,null,n.a.createElement(k.a,{onClick:function(){u(!0)},variant:"outline-success",size:"sm"},n.a.createElement(W.a,{icon:q.d})),n.a.createElement(G.a,{show:l,onHide:b},n.a.createElement(S.a,{onSubmit:function(e){if(e.preventDefault(),null!=t){var a=Object(D.a)(t.path);t!==J&&a.push({name:t.name,id:t.id}),p.folders.add({name:m,parentId:t.id,userId:f.uid,path:a,createdAt:p.getCurrentTimestamp()}),d(""),b()}}},n.a.createElement(G.a.Body,null,n.a.createElement(S.a.Group,null,n.a.createElement(S.a.Label,null,"Folder Name"),n.a.createElement(S.a.Control,{type:"text",required:!0,value:m,onChange:function(e){return d(e.target.value)}}))),n.a.createElement(G.a.Footer,null,n.a.createElement(k.a,{variant:"secondary",onClick:b},"Close"),n.a.createElement(k.a,{variant:"success",type:"submit"},"Add Folder")))))}var _=a(69),K=a(103),X=a(106);function Q(e){var t=e.currentFolder,a=Object(r.useState)([]),c=Object(o.a)(a,2),s=c[0],i=c[1],m=h().currentUser;return n.a.createElement(n.a.Fragment,null,n.a.createElement("label",{className:"btn btn-outline-success btn-sm m-0 mr-2"},n.a.createElement(W.a,{icon:q.b}),n.a.createElement("input",{type:"file",onChange:function(e){var a=e.target.files[0];if(null!=t&&null!=a){var r=Object(_.v4)();i((function(e){return[].concat(Object(D.a)(e),[{id:r,name:a.name,progress:0,error:!1}])}));var n=t===J?"".concat(t.path.join("/"),"/").concat(a.name):"".concat(t.path.join("/"),"/").concat(t.name,"/").concat(a.name),c=f.ref("/files/".concat(m.uid,"/").concat(n)).put(a);c.on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes;i((function(e){return e.map((function(e){return e.id===r?Object(u.a)(Object(u.a)({},e),{},{progress:t}):e}))}))}),(function(){i((function(e){return e.map((function(e){return e.id===r?Object(u.a)(Object(u.a)({},e),{},{error:!0}):e}))}))}),(function(){i((function(e){return e.filter((function(e){return e.id!==r}))})),c.snapshot.ref.getDownloadURL().then((function(e){p.files.where("name","==",a.name).where("userId","==",m.uid).where("folderId","==",t.id).get().then((function(r){var n=r.docs[0];n?n.ref.update({url:e}):p.files.add({url:e,name:a.name,createdAt:p.getCurrentTimestamp(),folderId:t.id,userId:m.uid})}))}))}))}},style:{opacity:0,position:"absolute",left:"-9999px"}})),s.length>0&&l.a.createPortal(n.a.createElement("div",{style:{position:"absolute",bottom:"1rem",right:"1rem",maxWidth:"250px"}},s.map((function(e){return n.a.createElement(K.a,{key:e.id,onClose:function(){i((function(t){return t.filter((function(t){return t.id!==e.id}))}))}},n.a.createElement(K.a.Header,{closeButton:e.error,className:"text-truncate w-100 d-block"},e.name),n.a.createElement(K.a.Body,null,n.a.createElement(X.a,{animated:!e.error,variant:e.error?"danger":"primary",now:e.error?100:100*e.progress,label:e.error?"Error":"".concat(Math.round(100*e.progress),"%")})))}))),document.body))}function Y(e){var t=e.folder;return n.a.createElement(k.a,{to:{pathname:"/folder/".concat(t.id),state:{folder:t}},variant:"outline-dark",className:"text-truncate w-100",as:g.b},n.a.createElement(W.a,{icon:q.c,className:"mr-2"}),t.name)}function $(e){var t=e.file;return n.a.createElement("a",{href:t.url,target:"_blank",className:"btn btn-outline-dark text-truncate w-100"},n.a.createElement(W.a,{icon:q.a,className:"mr-2"}),t.name)}var ee=a(104),te=a(102);var ae=function(){return n.a.createElement(ee.a,{bg:"light",expanded:"sm"},n.a.createElement(ee.a.Brand,{as:g.b,to:"/"},"HrriodyV2 Drive"),n.a.createElement(te.a.Link,{as:g.b,to:"/user"},"Profile"))},re=a(107);function ne(e){var t=e.currentFolder,a=t===J?[]:[J];return t&&(a=[].concat(Object(D.a)(a),Object(D.a)(t.path))),n.a.createElement(re.a,{className:"flex-grow-1",listProps:{className:"bg-white pl-0 m-0"}},a.map((function(e,t){return n.a.createElement(re.a.Item,{key:e.id,linkAs:g.b,linkProps:{to:{pathname:e.id?"/folder/".concat(e.id):"/",state:{folder:Object(u.a)(Object(u.a)({},e),{},{path:a.slice(1,t)})}}},className:"text-truncate d-inline-block",style:{maxWidth:"150px"}},e.name)})),t&&n.a.createElement(re.a.Item,{className:"text-truncate d-inline-block",style:{maxWidth:"200px"},active:!0},t.name))}function ce(){var e=Object(j.i)().folderId,t=Object(j.h)().state,a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=Object(r.useReducer)(M,{folderId:e,folder:t,childFolders:[],childFiles:[]}),n=Object(o.a)(a,2),c=n[0],l=n[1],u=h(),s=u.currentUser;return Object(r.useEffect)((function(){l({type:T,payload:{folderId:e,folder:t}})}),[e,t]),Object(r.useEffect)((function(){if(null==e)return l({type:H,payload:{folder:J}});p.folders.doc(e).get().then((function(e){l({type:H,payload:{folder:p.formatDoc(e)}})})).catch((function(){l({type:H,payload:{folder:J}})}))}),[e]),Object(r.useEffect)((function(){return p.folders.where("parentId","==",e).where("userId","==",s.uid).orderBy("createdAt").onSnapshot((function(e){l({type:V,payload:{childFolders:e.docs.map(p.formatDoc)}})}))}),[e,s]),Object(r.useEffect)((function(){return p.files.where("folderId","==",e).where("userId","==",s.uid).onSnapshot((function(e){l({type:z,payload:{childFiles:e.docs.map(p.formatDoc)}})}))}),[e,s]),c}(e,(void 0===t?{}:t).folder),c=a.folder,l=a.childFolders,u=a.childFiles;return n.a.createElement(n.a.Fragment,null,n.a.createElement(ae,null),n.a.createElement(C.a,{fluid:!0},n.a.createElement("div",{className:"d-flex align-items-center"},n.a.createElement(ne,{currentFolder:c}),n.a.createElement(Q,{currentFolder:c}),n.a.createElement(Z,{currentFolder:c})),l.length>0&&n.a.createElement("div",{className:"d-flex flex-wrap"},l.map((function(e){return n.a.createElement("div",{key:e.id,style:{maxWidth:"250px"},className:"p-2"},n.a.createElement(Y,{folder:e}))}))),l.length>0&&u.length>0&&n.a.createElement("hr",null),u.length>0&&n.a.createElement("div",{className:"d-flex flex-wrap"},u.map((function(e){return n.a.createElement("div",{key:e.id,style:{maxWidth:"250px"},className:"p-2"},n.a.createElement($,{file:e}))})))))}var le=function(){return n.a.createElement(g.a,null,n.a.createElement(v,null,n.a.createElement(j.d,null,n.a.createElement(U,{exact:!0,path:"/",component:ce}),n.a.createElement(U,{path:"/user",component:F}),n.a.createElement(U,{path:"/update-profile",component:B}),n.a.createElement(U,{exact:!0,path:"/folder/:folderId",component:ce}),n.a.createElement(j.b,{path:"/signup",component:R}),n.a.createElement(j.b,{path:"/login",component:P}),n.a.createElement(j.b,{path:"/forgot-password",component:A}))))};a(93);l.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(le,null)),document.getElementById("root"))}},[[73,1,2]]]);
//# sourceMappingURL=main.d13bad99.chunk.js.map